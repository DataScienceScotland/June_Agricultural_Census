---
title: "JAC Validation Errors"
date: "`r Sys.Date()`"
sgtemplates:
  datatables:
    features:
      info: true
      ordering: true
      paging: true
      searching: false
  header:
    phase_banner:
      tag: "WIP"
      text: "This is a work in progress."
    site_branding: "Scottish Government"
  metadata:
    label: "Report"
  navigation:
    toc:
      sticky: false
output:
  html_document:
    code_download: false
    df_print: paged
    fig_caption: true
    number_sections: false
    self_contained: false
    template: "_template.html"
    toc: true
    toc_depth: 2
    toc_float: false
---

```{r setup, include = FALSE }
library(tidyverse)
library(knitr)
library(writexl)
#yr = this year 20xx
yr <- 2023
yr1 <- yr-1 
yr2 <-  yr-2
yr3 <-  yr-3
yr_list <- c(yr, yr2, yr3)

knitr::opts_chunk$set(echo = FALSE)



# Before import -----------------------------------------------------------


# Clear environment prior
rm (list=(ls()))

# Datashare file path for import and export

Code_directory <-
  ("//s0177a/datashare/seerad/ags/census/branch1/NewStructure/Surveys/June/Codeconversion_2023")

# ADM schema for export

server <- "s0196a\\ADM"
database <- "RuralAndEnvironmentalScienceFarmingStatistics"
schema <- "juneagriculturalsurvey2023alpha"

#Script containing datasets and validations
source("./June-C-Validations_files/June - C-Validations.R",  local = knitr::knit_global())

```

# JAC Survey form Validations

# Section 1 Area of Holdings

## Error 1

The following table displays errors for holdings where total area is not equal to area rented (item20226 (2023 onwards) item7 (up to 2021)) + area owned (item 11) by 3ha or more. The column "Errx_diff" gives the difference (x = error number).

```{r, June - C-Validations-err1, results = 'markup'}

  ifelse(nrow(err1) ==0, "No errors found", "Errors found - item12 != item7 + item11)")
kable(err1, caption = "Total area of holding NOT equal to area rented + area owned (item12 != item7 + item11)")

```

## Error 37

The following table displays errors for holdings where total area is zero or missing AND area owned or area rented are greater than zero

```{r, June - C-Validations-err37, results = 'markup'}

  ifelse(nrow(err37) ==0, "No errors found", "Errors found ")
kable(err37, caption = "Total area of holding is zero or missing AND area owned or area rented are greater than zero")

```

## Error 38

The following table displays potential errors for holdings where total area is zero or missing AND area owned and area rented are zero or missing

```{r, June - C-Validations-err38, results = 'markup'}

  ifelse(nrow(err38) ==0, "No errors found", "Errors found ")
kable(err38, caption = "Total area of holding is zero or missing AND area owned and area rented are zero or missing")

```

## Error 57

The following table displays potential errors for holdings where area rented is greater/less than RP&S value by 30ha or more. The column "Errx_diff" gives the difference (x = error number).

```{r, June - C-Validations-err57, results = 'markup'}

  ifelse(nrow(err57) ==0, "No errors found", "Errors found ")
kable(err57, caption = "Total area rented greater/less than RP&S value by 30ha or more")

```

## Error 59

The following table displays potential errors for holdings where area owned greater/less than RP&S value by 30ha or more. The column "Errx_diff" gives the difference (x = error number).

```{r, June - C-Validations-err59, results = 'markup'}

  ifelse(nrow(err59) ==0, "No errors found", "Errors found ")
kable(err59, caption = "Total area owned greater/less than RP&S value by 30ha or more")

```

# Section 2 Seasonal Rents

## Error 2

The following table displays possible errors for holdings where total seasonal rent (item2) matches with area rented on full tenancy (item20026, section 1). The column "Errx_diff" gives the difference (x = error number).

```{r, June - C-Validations-err2, results = 'markup'}
  ifelse(nrow(err2) ==0, "No errors found", "Errors found - item2 = item20026")
kable(err2, caption = "Total seasonal rents equal to  area rented on full tenancy (item2 = item20026)")

```

## Error 3

The following table displays possible errors for holdings where seasonal let items (item2827, item2828) are not equal to seasonal lets total (item2). The column "Errx_diff" gives the difference (x = error number).

```{r, June - C-Validations-err3, results = 'markup'}
  ifelse(nrow(err3) ==0, "No errors found", "Errors found - item2827 + item2828 != item2")
kable(err3, caption = "Seasonal let items (item2827, item2828) are not equal to seasonal lets total (item2)")

```

## Error 43

The following table displays possible errors for holdings where land seasonally rented out is greater than total area

```{r, June - C-Validations-err43, results = 'markup'}
  ifelse(nrow(err43) ==0, "No errors found", "Errors found")
kable(err43, caption = "Land seasonally rented out greater than total area")

```

# Section 3 Land Use

## Error 4 - Crops

The following table displays possible errors for holdings where area of unspecified "other" crops is non-zero but no name is provided

```{r, June - C-Validations-err4, results = 'markup'}
ifelse(nrow(err4) ==0,  "No errors found", "Errors found- item41 > 0 but item185 not specified ")
kable(err4, caption = "Unspecified `other` crops area (item41) is non-zero but no name provided (item185) " )
```

## Error 44 - Crops

The following table displays possible errors for holdings where names of other crops are specified but area of unspecified "other" crops is zero

```{r, June - C-Validations-err44, results = 'markup'}
ifelse(nrow(err44) ==0,  "No errors found", "Errors found")
kable(err44, caption = "Unspecified `other` crops area is zero but name is/ names are given " )
```

## Error 5 - Crops (SAF total area of crops and grassland)

The following table displays possible errors for holdings where total area of crops and grassland (item46), rough grazing (item47), woodland (item48) and other land (item49) differs from total land (item50) by more than 3ha. The column "Errx_diff" gives the difference (x = error number) (SAF).

```{r, June - C-Validations-err5, results = 'markup'}
ifelse(nrow(err5) ==0,  "No errors found", "Errors found - sum(item46:49) != item50")
kable(err5, caption = "Total area of crops and grassland (item46), rough grazing (item47), woodland (item48) and other land (item49) is not equal to total land (item50) " )

```

<!-- ##Error 6 - Veg for Human Consumption -->

<!-- The following table displays possible errors for holdings where SAF veg items (item52:item67) are not equal to total veg (item68) -->

<!-- ```{r, June - C-Validations-err6, results = 'markup'} -->

<!-- ifelse(nrow(err6) ==0,  "No errors found", "Errors found- sum(item52:item67 != item68") -->

<!-- kable(err6, caption = "SAF veg items (item52:item67) are not equal to total veg (item68)" ) -->

<!-- ``` -->

## Error 7 - Veg for Human Consumption

The following table displays possible errors for holdings where total veg (SAF, item86) is not equal to total veg (census, item35 / item 27730 (2023)). The column "Errx_diff" gives the difference (x = error number).

```{r, June - C-Validations-err7, results = 'markup'}
ifelse(nrow(err7) ==0,  "No errors found", "Errors found - item35 != item68")
kable(err7, caption = "Total veg (SAF, item86) is not equal to total veg (census, item35 / item 27730 (2023))" )

```

<!-- ## Error 8 - Fruit grown in the open -->

<!-- The following table displays possible errors for holdings where fruit grown in the open (item70:72, item75, item2832) is not equal to all fruit (SAF, item76) -->

<!-- ```{r, June - C-Validations-err8, results = 'markup'}  -->

<!-- ifelse(nrow(err8) ==0,  "No errors found", "Errors found - sum(item70:72, item75, item2832) != item76)") -->

<!-- kable(err8, caption = "Fruit grown in the open (item70:72, item75, item2832) is not equal to all fruit (SAF, item76)") -->

<!-- ``` -->

## Error 9 - Fruit grown in the open

The following table displays possible errors for holdings where soft fruit area (item37) is not equal to all fruit (SAF, item76). The column "Errx_diff" gives the difference (x = error number).

```{r, June - C-Validations-err9, results = 'markup'}
ifelse(nrow(err9) ==0,  "No errors found", "Errors found - item37 != item76")
kable(err9, caption = "Soft fruit area (item37) is not equal to all fruit (SAF, item76)" )

```

<!-- ##Error 10 - Flowers, bulbs and nursery stock grown in the open -->

<!-- The following table displays possible errors for holdings where flowers, bulbs and nursery stock (items 80:83, item1709:1710, item2324) are not equal to total (item84/ item27740 (2023)). The column "Errx_diff" gives the difference (x = error number). -->

<!-- ```{r, June - C-Validations-err10, results = 'markup'}  -->

<!-- ifelse(nrow(err10) ==0,  "No errors found", "Errors found - sum(item80:item83, item1709, item1710, item2324 != item84/item27740") -->

<!-- kable(err10, caption = "Flowers, bulbs and nursery stock (item80:83, item1709:1710, item2324) are not equal to total (item84/ item27740 (2023)" ) -->

<!-- ``` -->

## Error 11 - Glasshouses

The following table displays possible errors for holdings where the area of glasshouse crops is larger than the area of glasshouses (open soil or solid floor).The column "Errx_diff" gives the difference (x = error number).

```{r, June - C-Validations-err11, results = 'markup'}
ifelse(nrow(err11) ==0,  "No errors found", "Errors found")
kable(err11, caption = "Area of glasshouse crops is larger than the area of glasshouse (open soil or solid floor)" )

```

## Error 12 - Glasshouses

The following table displays possible errors for holdings where glasshouses are indicated but items are not specified. The column "Errx_diff" gives the difference (x = error number).

```{r, June - C-Validations-err12, results = 'markup'}
ifelse(nrow(err12) ==0,  "No errors found", "Errors found")
kable(err12, caption = "Glasshouses are indicated but glasshouse items are not specified" )

```

## Error 45 - Glasshouses and outdoor areas (SUMMARY VALUES- AGS error)

The following table displays possible errors for holdings where difference between total land use area and the sum of the outdoor areas and glasshouses is greater than 3ha. The column "Errx_diff" gives the difference (x = error number).

```{r, June - C-Validations-err45, results = 'markup'}
ifelse(nrow(err45) ==0,  "No errors found", "Errors found")
kable(err45, caption = "Total land use area does not equal the sum of the outdoor areas and glasshouses" )

```

## Error 46 - Total Land (end of section 3)

The following table displays possible errors for holdings where the difference between total land use area and the total area (section 1) is greater than 3ha. The column "Errx_diff" gives the difference (x = error number).

```{r, June - C-Validations-err46, results = 'markup'}
ifelse(nrow(err46) ==0,  "No errors found", "Errors found")
kable(err46, caption = "Total land use area does not equal the total area (section 1)" )

```

# Section 4 Pigs

## Error 13

The following table displays possible errors for holdings where pig items (item146-156) are not equal to total pigs (item157). The column "Errx_diff" gives the difference (x = error number).

```{r, June - C-Validations-err13, results = 'markup'}
ifelse(nrow(err13) ==0,  "No errors found", "Errors found - sum(item146:156 != item157")
kable(err13, caption = "Pig items (item146-156) are not equal to total pigs (item157)" )

```

## Error 14

The following table displays possible errors for holdings where some pig items (item146-156) are not given as whole numbers.

```{r, June - C-Validations-err14, results = 'markup'}
ifelse(nrow(err14) ==0,  "No errors found", "Errors found ")
kable(err14, caption = "Pig items(item146-156) are not given as whole numbers" )

```

# Section 5 Sheep

## Error 15

The following table displays possible errors for holdings where sheep items (items 139-141, 143-144) are not equal to total sheep (item145). The column "Errx_diff" gives the difference (x = error number).

```{r, June - C-Validations-err15, results = 'markup'}
ifelse(nrow(err15) ==0,  "No errors found", "Errors found - sum(item139:141, item143:144) != item145")
kable(err15, caption = "Sheep items (items 139-141, 143-144) are not equal to total sheep (item145)" )

```

## Error 16

The following table displays possible errors for holdings where some sheep items (items 139-141, 143-144) are not given as whole numbers

```{r, June - C-Validations-err16, results = 'markup'}
ifelse(nrow(err16) ==0,  "No errors found", "Errors found ")
kable(err16, caption = "Sheep items(items 139-141, 143-144) are not given as whole numbers" )

```

# Section 6 Poultry

## Error 17

The following table displays possible errors for holdings where poultry items (item158-164, item167, item1708, item2038-2039) are not equal to total poultry (item170). The column "Errx_diff" gives the difference (x = error number).

```{r, June - C-Validations-err17, results = 'markup'}
ifelse(nrow(err17) ==0,  "No errors found", "Errors found - sum(item158-164, item167, item1708, item2038-2039) != item170")
kable(err17, caption = "Poultry items (item158-164, item167, item1708, item2038-2039) are not equal to total poultry (item170)" )

```

## Error 18

The following table displays possible errors for holdings where poultry items (item158-164, item167, item1708, item2038-2039) are not given as whole numbers

```{r, June - C-Validations-err18, results = 'markup'}
ifelse(nrow(err18) ==0,  "No errors found", "Errors found ")
kable(err18, caption = "Poultry items (item158-164, item167, item1708, item2038-2039)  are not given as whole numbers" )

```

## Error 19

The following table displays possible errors for holdings where egg producing fowl (item158-162, 164) are equal to zero whilst cocks (item163) are greater than 9

```{r, June - C-Validations-err19, results = 'markup'}
ifelse(nrow(err19) ==0,  "No errors found", "Errors found - sum(item158-162, item164) == 0 & item163 > 9")
kable(err19, caption = "Egg producing fowl (item158-162, 164) are equal to zero whilst cocks  (item163) are greater than 9" )

```

# Section 7 Miscellaneous Livestock

## Error 20

The following table displays possible errors for holdings where not all deer (item194) are given as whole numbers

```{r, June - C-Validations-err20, results = 'markup'}
ifelse(nrow(err20) ==0,  "No errors found", "Errors found")
kable(err20, caption = "Not all deer (item194) are given as whole numbers" )

```

## Error 21

The following table displays possible errors for holdings where not all camelids (item2472:2474) are given as whole numbers

```{r, June - C-Validations-err21, results = 'markup'}
ifelse(nrow(err21) ==0,  "No errors found", "Errors found")
kable(err21, caption = "Not all camelids (item2472:2474) are given as whole numbers" )

```

## Error 22

The following table displays possible errors for holdings where not all beehives (item2826) are given as whole numbers

```{r, June - C-Validations-err22, results = 'markup'}
ifelse(nrow(err22) ==0,  "No errors found", "Errors found")
kable(err22, caption = "Not all beehives (item2826) are given as whole numbers" )

```

## Error 23

The following table displays possible errors for holdings where not all other livestock (item171) are given as whole numbers

```{r, June - C-Validations-err23, results = 'markup'}
ifelse(nrow(err23) ==0,  "No errors found", "Errors found - item171 >0 but item186 is not given")
kable(err23, caption = " Not all other livestock (item171) are given as whole numbers" )

```

## Error 24

The following table displays possible errors for holdings where other livestock (item171) is non-zero but no livestock are named (item186)

```{r, June - C-Validations-err24, results = 'markup'}
ifelse(nrow(err24) ==0,  "No errors found", "Errors found - item171 >0 but item186 is not given")
kable(err24, caption = "Other livestock (item171) is non-zero but no livestock are named (item186)" )

```

## Error 47

The following table displays possible errors for holdings where other livestock have been named (item186) but number (item171) is not given

```{r, June - C-Validations-err47, results = 'markup'}
ifelse(nrow(err47) ==0,  "No errors found", "Errors found")
kable(err47, caption = "Other livestock have been named (item186) but number (item171) is not given" )

```

<!-- ## Error 25 -->

<!-- The following table displays possible errors for holdings where not all horses/donkeys are given as whole numbers -->

<!-- ```{r, June - C-Validations-err25, results = 'markup'}  -->

<!-- ifelse(nrow(err25) ==0,  "No errors found", "Errors found") -->

<!-- kable(err25, caption = " Not all horses/donkeys (item95:96/item2868 are given as whole numbers" ) -->

<!-- ``` -->

<!-- ## Error 26 -->

<!-- The following table displays possible errors for holdings where not all goats are given as whole numbers -->

<!-- ```{r, June - C-Validations-err26, results = 'markup'}  -->

<!-- ifelse(nrow(err26) ==0,  "No errors found", "Errors found") -->

<!-- kable(err26, caption = " Not all goats (item98, item1712:1713) are given as whole numbers" ) -->

<!-- ``` -->

## Error 27

The following table displays possible errors for holdings where not all horses/donkeys are given as whole numbers

```{r, June - C-Validations-err25, results = 'markup'}
ifelse(nrow(err27) ==0,  "No errors found", "Errors found")
kable(err27, caption = " Not all horses/donkeys (item27775/item2868 are given as whole numbers" )

```

## Error 28

The following table displays possible errors for holdings where not all goats are given as whole numbers

```{r, June - C-Validations-err26, results = 'markup'}
ifelse(nrow(err27) ==0,  "No errors found", "Errors found")
kable(err27, caption = " Not all goats (item27780) are given as whole numbers" )

```

# Section 8 Legal Responsibility

##Error60 The following table displays possible errors for holdings where the legal responsbility box is not ticked (item2727) and no legal responsibility details (item2980) are given

```{r, June - C-Validations-err60, results = 'markup'}
ifelse(nrow(err60) ==0,  "No errors found", "Errors found")
kable(err60, caption = "legal responsbility box is not ticked (item2727) and no legal responsibility details (item2980) are given" )
```

##Error29 The following table displays possible errors for holdings where the legal responsbility box is ticked (item2727) and details for occupier1/2 are given

```{r, June - C-Validations-err29, results = 'markup'}
ifelse(nrow(err29) ==0,  "No errors found", "Errors found")
kable(err29, caption = "Legal responsbility box is ticked  and  details for occupier1/2 are given" )
```

## Error 52

The following table displays possible errors for holdings where labour details NOT provided on another form this year & no Occupier 1 or occupier 2 work hours provided

```{r, June - C-Validations-err52, results = 'markup'}
ifelse(nrow(err52) ==0,  "No errors found", "Errors found")
kable(err52, caption = "Labour details NOT provided on another form this year & no Occupier 1 or occupier 2 work hours provided" )

```

## Error 53

The following table displays possible errors for holdings where legal and financial responsbility not indicated for Occupier 2 (when any Occupier 2 details have been provided for Occupier 2)

```{r, June - C-Validations-err53, results = 'markup'}
ifelse(nrow(err53) ==0,  "No errors found", "Errors found")
kable(err53, caption = "Legal and financial responsbility not indicated for Occupier 2 (when any Occupier 2 details have been provided for Occupier 2)" )

```

## Error 54

The following table displays possible errors for holdings where legal and financial responsbility indicated for Occupier 2 but no working time answered)

```{r, June - C-Validations-err54, results = 'markup'}
ifelse(nrow(err54) ==0,  "No errors found", "Errors found")
kable(err54, caption = "Legal and financial responsbility indicated for Occupier 2 but no working time answered" )

```

# Section 9 Occupiers

## Error 30

The following table displays possible errors for holdings where more than one entry for occupier 1 working hours has been provided

```{r, June - C-Validations-err30, results = 'markup'}
ifelse(nrow(err30) ==0,  "No errors found", "Errors found")
kable(err30, caption = "More than one entry for occupier 1 working hours has been provided" )

```

## Error 31

The following table displays possible errors for holdings where more than one entry for occupier 2 working hours has been provided

```{r, June - C-Validations-err31, results = 'markup'}
ifelse(nrow(err31) ==0,  "No errors found", "Errors found")
kable(err31, caption = "More than one entry for occupier 2 working hours has been provided" )

```

## Error 48

The following table displays possible errors for holdings where both male and female selected for occupier 1 or 2

```{r, June - C-Validations-err48, results = 'markup'}
ifelse(nrow(err48) ==0,  "No errors found", "Errors found")
kable(err48, caption = "Both male and female selected for occupier 1 or 2" )

```

## Error 49

The following table displays possible errors for holdings where occupier 1 gender selected but no working hours given

```{r, June - C-Validations-err49, results = 'markup'}
ifelse(nrow(err49) ==0,  "No errors found", "Errors found")
kable(err49, caption = "Occupier 1 gender selected but no working hours given" )

```

## Error 50

The following table displays possible errors for holdings where occupier 2 gender selected but no working hours given

```{r, June - C-Validations-err50, results = 'markup'}
ifelse(nrow(err50) ==0,  "No errors found", "Errors found")
kable(err50, caption = "Occupier 2 gender selected but no working hours given" )

```

## Error 51

The following table displays possible errors for holdings where year of birth for occupier 1 or 2 is not valid (ie before 1923 or after 2008)

```{r, June - C-Validations-err51, results = 'markup'}
ifelse(nrow(err51) ==0,  "No errors found", "Errors found")
kable(err51, caption = "Year of birth for occupier 1 or 2 is not valid (ie before 1923 or after 2008)" )

```

## Error 55

The following table displays possible errors for holdings where occupier 2 details given but not occupier 1

```{r, June - C-Validations-err55, results = 'markup'}
ifelse(nrow(err55) ==0,  "No errors found", "Errors found")
kable(err55, caption = "Occupier 2 details given but not occupier 1" )

```

# Section 10 Other labour on the location

## Error 32

The following table displays possible errors for holdings where total labour (item200) is not equal to sum of labour items. The column "Errx_diff" gives the difference (x = error number).

```{r, June - C-Validations-err32, results = 'markup'}
ifelse(nrow(err32) ==0,  "No errors found", "Errors found")
kable(err32, caption = "Total labour (item200) is not equal to sum of labour items" )

```

## Error 33

The following table displays possible errors for holdings where not all labour items are given as whole numbers

```{r, June - C-Validations-err33, results = 'markup'}
ifelse(nrow(err33) ==0,  "No errors found", "Errors found")
kable(err33, caption = "Not all labour items are given as whole numbers" )

```

# Crofts

<!-- ## Error 34 -->

<!-- The following table displays possible errors for holdings where owned croft area (item2249) is greater than owned area (item11) -->

<!-- ```{r, June - C-Validations-err34, results = 'markup'}  -->

<!-- ifelse(nrow(err34) ==0,  "No errors found", "Errors found") -->

<!-- kable(err34, caption = "Owned croft area (item2249) is greater than owned area (item11)" ) -->

<!-- ``` -->

<!-- ## Error 35 -->

<!-- The following table displays possible errors for holdings in a non-crofting parish with an owned croft (item2249) -->

<!-- ```{r, June - C-Validations-err35, results = 'markup'}  -->

<!-- ifelse(nrow(err35) ==0,  "No errors found", "Errors found") -->

<!-- kable(err35, caption = "Holdings in a non-crofting parish with an owned croft (item2249)" ) -->

<!-- ``` -->

<!-- ## Error 36 -->

<!-- The following table displays possible errors for holdings in a non-crofting parish with a rented croft (item2251) -->

<!-- ```{r, June - C-Validations-err36, results = 'markup'}  -->

<!-- ifelse(nrow(err36) ==0,  "No errors found", "Errors found") -->

<!-- kable(err36, caption = "Holdings in a non-crofting parish with a rented croft (item2251)" ) -->

<!-- ``` -->

# Migrant error checks

## Error 39

The following table displays possible errors for holdings where soft fruit labour is too low

```{r, June - C-Validations-err39, results = 'markup'}
ifelse(nrow(err39) ==0,  "No errors found", "Errors found- check whether missed other labour e.g. migrants")
err39 <- err39 %>% rename( "Total soft fruit area (by brn) = sumfruit_sum "= "sumfruit_sum", "Total soft fruit area (holding) = sumfruit" = "sumfruit", "Total labour FTE (by brn) = lab_returned_sum" = "lab_returned_sum", "Total labour FTE (holding) = lab_returned" = "lab_returned", "SLR (by brn) = slr_fruit_sum" = "slr_fruit_sum", "SLR (holding) = slr_fruit" = "slr_fruit")
kable(err39, caption = "Holdings where soft fruit labour is too low" )

```

## Error 40

The following table displays possible errors for holdings where soft fruit labour is too high

```{r, June - C-Validations-err40, results = 'markup'}
ifelse(nrow(err40) ==0,  "No errors found", "Errors found- che- check for punch errors or misunderstanding of requirement of people/days in labour questions")
err40 <- err40 %>% rename( "Total soft fruit area (by brn) = sumfruit_sum "= "sumfruit_sum", "Total soft fruit area (holding) = sumfruit" = "sumfruit", "Total labour FTE (by brn) = lab_returned_sum" = "lab_returned_sum", "Total labour FTE (holding) = lab_returned" = "lab_returned", "SLR (by brn) = slr_fruit_sum" = "slr_fruit_sum", "SLR (holding) = slr_fruit" = "slr_fruit")
kable(err40, caption = "Holdings where soft fruit labour is too high" )

```

## Error 41

The following table displays possible errors for holdings where soft fruit labour is too low

```{r, June - C-Validations-err41, results = 'markup'}
ifelse(nrow(err41) ==0,  "No errors found", "Errors found- check whether missed other labour e.g. migrants")
err41 <- err41 %>% rename( "Total soft fruit area (holding) = sumfruit" = "sumfruit", "Total labour FTE (holding) = lab_returned" = "lab_returned", "SLR (holding) = slr_fruit" = "slr_fruit")
kable(err41, caption = "Holdings where soft fruit labour is too low" )

```

## Error 42

The following table displays possible errors for holdings where soft fruit labour is too high

```{r, June - C-Validations-err42, results = 'markup'}
ifelse(nrow(err42) ==0,  "No errors found", "Errors found- check for punch errors or misunderstanding of requirement of people/days in labour questions")
err42 <- err42 %>% rename("Total soft fruit area (holding) = sumfruit" = "sumfruit", "Total labour FTE (holding) = lab_returned" = "lab_returned", "SLR (holding) = slr_fruit" = "slr_fruit")
kable(err42, caption = "Holdings where soft fruit labour is too high" )

```

# Validation Error Summary Table

The following table display the count of validation errors. The total cases with errors is given on the final row.

```{r, June - C-Validations-err-summary, results = 'markup'}

kable(JAC_validation_error_summary, caption = "Count of validation errors")
#kable(JAC_validation_error_summary_NA, caption = "Count of validation errors including NA cases")

```

<!-- The following table displays the count of validation errors compared with SAS.  -->

<!-- ```{r, results = 'markup'}  -->

<!-- kable(SAS_R_comparison, caption = "Count of validation errors vs SAS") -->

<!-- kable(SAS_R_NAcomparison, caption = "Count of validation errors (including NA) vs SAS") -->

<!-- ``` -->

The following table displays the count of possible migrant labour errors for soft fruit holdings.

```{r, results = 'markup'}

kable(check_labour_error_summary, caption = "Count of labour errors for soft fruit holdings")

```

<!-- The following table displays the count of new validation errors.  -->

<!-- ```{r, results = 'markup'}  -->

<!-- kable(JAC_new_validation_error_summary, caption = "Count of new validation errors") -->

<!-- ``` -->
